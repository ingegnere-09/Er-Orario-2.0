<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="icon" href="https://i.ibb.co/zJfV8HJ/icona-sito.png" type="image/x-icon">
    <title>ER ORARIO 2.0</title>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M12YF4T24Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M12YF4T24Z');
</script>
<body>
    <div class="porta_tit">
        <h1 class="title"><a class="title" href="index.html">ER ORARIO 2.0</a></h1>
    </div>
    <div class="warn">
        <h4 class="warn-sc">Attenzione: nei primi giorni l’orario potrebbe subire variazioni. Le informazioni presenti potrebbero non essere aggiornate.</h4>
    </div>
    <div id="materie"></div>
    <script>
        fetch('materie.json')
            .then(response => response.json())
            .then(data => {
                const giorni = ["lunedì", "martedì", "mercoledì", "giovedì", "venerdì"];
                const oggi = new Date();
                const giorno = oggi.getDay(); // 0: domenica, 1: lunedì, ..., 6: sabato
                let prossimoGiorno = (giorno + 1) % 7; // giorno successivo

                // Map dei giorni
                const giornoSettimana = ["domenica", "lunedì", "martedì", "mercoledì", "giovedì", "venerdì", "sabato"];
                const nomeGiorno = giornoSettimana[prossimoGiorno];

                if (nomeGiorno === "sabato") {
                    document.getElementById('materie').innerHTML = "<h3><b>Weekend in arrivo! Smetti di pensare allo zaino e concediti un po' di relax; il resto può aspettare.</b></h3>";
                } else if (nomeGiorno === "domenica") {
                    document.getElementById('materie').innerHTML = "<h3><b>Sabato! Approfitta di questa giornata per ricaricare le energie e lascia lo zaino in pace; il relax è la tua priorità oggi.</b></h3>";
                } else if (giorni.includes(nomeGiorno)) {
                    const materie = data[nomeGiorno];
                    document.getElementById('materie').innerHTML = `<ul>${materie.map(m => `<li class="mt"><b>${m}</b></li>`).join('')}</ul>`;
                }

                // Creazione della tabella per tutti i giorni
                let tableContent = `<tr><th><i>Giorno</i></th><th><i>Materie</i></th></tr>`;
                giorni.forEach(giorno => {
                    if (data[giorno]) {
                        tableContent += `<tr><td><b><i>${giorno.charAt(0).toUpperCase() + giorno.slice(1)}</i></b></td><td>${data[giorno].join(', ')}</td></tr>`;
                    }
                });
                document.querySelector('table').innerHTML = tableContent;
            });
    </script>

    <p class="giorno">Queste sono le materie per il giorno successivo</p>
    <hr class="riga1">

    <table border="1" cellpadding="10" cellspacing="0" style="width: 100%; text-align:left;">
        <thead>
            <tr>
                <th>Giorno</th>
                <th>Materie</th>
            </tr>
        </thead>
        <tbody id="orarioTable">
            <!-- I dati verranno inseriti qui via JavaScript -->
        </tbody>
    </table>

    <hr class="riga2">
    <h2>PROSSIME FESTIVITÀ</h2>
    <table border="1" cellpadding="10" cellspacing="0" style="width: 100%; text-align:left;" id="festivitaTable">
        <thead>
            <tr>
                <th>Festività</th>
                <th>Data</th>
                <th>Tempo rimanente</th>
            </tr>
        </thead>
        <tbody>
            <!-- Festività verranno inserite dinamicamente -->
        </tbody>
    </table>

    <hr class="riga2">

    <script>
    (function() {
        // Funzione per calcolare la data di Pasqua (algoritmo di Meeus)
        function calcolaPasqua(anno) {
            var a = anno % 19;
            var b = Math.floor(anno / 100);
            var c = anno % 100;
            var d = Math.floor(b / 4);
            var e = b % 4;
            var f = Math.floor((b + 8) / 25);
            var g = Math.floor((b - f + 1) / 3);
            var h = (19 * a + b - d - g + 15) % 30;
            var i = Math.floor(c / 4);
            var k = c % 4;
            var l = (32 + 2 * e + 2 * i - h - k) % 7;
            var m = Math.floor((a + 11 * h + 22 * l) / 451);
            var mese = Math.floor((h + l - 7 * m + 114) / 31); // 3=marzo, 4=aprile
            var giorno = ((h + l - 7 * m + 114) % 31) + 1;
            return new Date(anno, mese - 1, giorno, 0, 0, 0, 0);
        }

        // Funzione per formattare la data in formato gg/mm/yyyy
        function formatDate(date) {
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }

        // Calcola il tempo rimanente in giorni, ore, minuti, secondi
        function getRemainingTime(targetDate, now) {
            let distanza = targetDate.getTime() - now.getTime();
            if (distanza < 0) distanza = 0;
            const secondi = Math.floor(distanza / 1000) % 60;
            const minuti = Math.floor(distanza / (1000 * 60)) % 60;
            const ore = Math.floor(distanza / (1000 * 60 * 60)) % 24;
            const giorni = Math.floor(distanza / (1000 * 60 * 60 * 24));
            return { giorni, ore, minuti, secondi };
        }

        // Festività principali italiane
        function getFestivita(anno) {
            var pasqua = calcolaPasqua(anno);
            var lunediAngelo = new Date(pasqua); lunediAngelo.setDate(pasqua.getDate() + 1);
            return [
                { nome: "Capodanno", data: new Date(anno, 0, 1, 0, 0, 0, 0) },
                { nome: "Epifania", data: new Date(anno, 0, 6, 0, 0, 0, 0) },
                { nome: "Pasqua", data: pasqua },
                { nome: "Lunedì dell’Angelo", data: lunediAngelo },
                { nome: "Festa della Liberazione", data: new Date(anno, 3, 25, 0, 0, 0, 0) },
                { nome: "Festa dei Lavoratori", data: new Date(anno, 4, 1, 0, 0, 0, 0) },
                { nome: "Festa della Repubblica", data: new Date(anno, 5, 2, 0, 0, 0, 0) },
                { nome: "Ferragosto", data: new Date(anno, 7, 15, 0, 0, 0, 0) },
                { nome: "Tutti i santi", data: new Date(anno, 10, 1, 0, 0, 0, 0) },
                { nome: "Immacolata", data: new Date(anno, 11, 8, 0, 0, 0, 0) },
                { nome: "Natale", data: new Date(anno, 11, 25, 0, 0, 0, 0) },
                { nome: "Santo Stefano", data: new Date(anno, 11, 26, 0, 0, 0, 0) }
            ];
        }

        // Ottieni la prossima festività imminente
        function getNextFestivity(festivitaList, now) {
            for (let i = 0; i < festivitaList.length; i++) {
                if (festivitaList[i].data.getTime() > now.getTime()) {
                    return festivitaList[i];
                }
            }
            return null;
        }

        function aggiornaTabellaFestivita() {
            const nowOriginal = new Date();
            // Per testare con una data fittizia, sostituire 'nowOriginal' con una nuova data, ad esempio:
            // const nowOriginal = new Date(2025, 8, 15); // 15 settembre 2025

            let anno = nowOriginal.getFullYear();
            let festivita = getFestivita(anno);

            // Se tutte le festività di quest'anno sono passate, prendi quelle dell'anno prossimo
            if (festivita.every(f => f.data.getTime() <= nowOriginal.getTime())) {
                anno++;
                festivita = getFestivita(anno);
            }

            // Creiamo una nuova data "now" con ore, minuti, secondi e millisecondi azzerati per confronto
            const now = new Date(nowOriginal.getFullYear(), nowOriginal.getMonth(), nowOriginal.getDate());

            // Filtra solo quelle future o oggi
            const festivitaFuture = festivita.filter(f => f.data.getTime() >= now.getTime());

            // Ordina per data
            festivitaFuture.sort((a,b) => a.data - b.data);

            const nextFest = getNextFestivity(festivitaFuture, nowOriginal);

            const tbody = document.querySelector('#festivitaTable tbody');
            tbody.innerHTML = '';

            festivitaFuture.forEach(f => {
                const tr = document.createElement('tr');
                if (nextFest && f.nome === nextFest.nome) {
                    tr.style.backgroundColor = '#d0eaff'; // evidenziazione minimal azzurra
                    tr.style.fontWeight = 'bold';
                }
                const tdNome = document.createElement('td');
                tdNome.textContent = f.nome;
                const tdData = document.createElement('td');
                tdData.textContent = formatDate(f.data);
                const tdTempo = document.createElement('td');
                const remaining = getRemainingTime(f.data, nowOriginal);
                tdTempo.textContent = `${remaining.giorni} gg, ${remaining.ore.toString().padStart(2,'0')}h, ${remaining.minuti.toString().padStart(2,'0')}m, ${remaining.secondi.toString().padStart(2,'0')}s`;
                tr.appendChild(tdNome);
                tr.appendChild(tdData);
                tr.appendChild(tdTempo);
                tbody.appendChild(tr);
            });
        }

        aggiornaTabellaFestivita();
        setInterval(aggiornaTabellaFestivita, 1000);
    })();
    </script>

    <h2 class="tit">LA STORIA</h2>
    <p class="storia">La storia del progetto orario inizia il primo novembre 2023, quando, in un momento di riflessione e senza sapere esattamente cosa fare, decisi di creare un orario personalizzabile e intuitivo. Grazie al sostegno dei miei compagni di classe, che hanno iniziato a utilizzare la prima versione e a fornire feedback, il progetto ha preso forma e si è evoluto. Ho dedicato innumerevoli ore davanti al computer, risolvendo bug e cercando soluzioni ottimali. Ogni aggiornamento ha migliorato la funzionalità e l’usabilità del sito, introducendo anche piccoli easter egg per rendere l’esperienza più divertente. Con l’inizio del nuovo anno scolastico 2024/25, sono entusiasta di presentare la nuova versione, pronta a supportare gli studenti nella gestione del loro tempo. Il progetto, che riflette il mio impegno e la mia passione, continuerà a crescere e a migliorare grazie alla fiducia e al supporto dei miei compagni di classe.</p>

    <hr class="riga2">
    <h2>NOVITÀ 2.0</h2>
    
    <p>La versione 2.0 per il 2025/26 introduce un countdown interattivo per l’inizio delle lezioni e nuovi easter egg nascosti, migliorando l’aspetto e l’esperienza d’uso per gli studenti.</p>

    <hr class="riga2">
    <h2 class="tit">DISCLAIMER</h2>
    <p id="dis">Utilizzando questo sito, accetti <a href="term.html">termini e condizioni</a>.</p>
    
    <hr class="riga2">
    <div class="fine">
        <h4 class="mini-img">Social: <a href="https://github.com/ingegnere-09" target="_blank"><i class="fab fa-github"></i></a> | <a href="https://www.instagram.com/ingegnere_09/" target="_blank"><i class="fab fa-instagram"></i></a> | <a href="https://www.threads.net/@ingegnere_09" target="_blank"><i class="fab fa-threads"></i></a> | <a href="https://discord.gg/6F8X6f7PXc" target="_blank"><i class="fab fa-discord"></i></a></h4>
        <h4 class="sc-fine">Email: <a href="mailto:berrettagregorio@gmail.com">berrettagregorio@gmail.com</a></h4>
        <link rel="icon" href="https://i.ibb.co/FsZ9NNF/favicon-48x48.png" type="image/x-icon">
        <hr>
    </div>
 
    <h6>© 2025 er-orario-2-0.vercel.app. Tutti i diritti riservati. È vietata la riproduzione, anche parziale, senza autorizzazione.</h6>

    <!-- Parte x i accetto -->
    
    <script>
        // JavaScript incluso direttamente nell'HTML
        document.addEventListener('DOMContentLoaded', function() {
            const polDiv = document.querySelector('.pol');

            polDiv.addEventListener('click', function() {
                polDiv.classList.add('hidden');
            });
        });
    </script>
    </script>
         <a class="copyrighted-badge" title="Copyrighted.com Registered &amp; Protected" target="_blank" href="https://app.copyrighted.com/website/wMLXougaDKkQu4gd/"><img alt="Copyrighted.com Registered &amp; Protected" border="0" width="125" height="75" srcset="https://static.copyrighted.com/badges/125x75/06_2x.png 2x" src="https://static.copyrighted.com/badges/125x75/06.png"></a><script src="https://static.copyrighted.com/badges/helper.js"></script>
</body>
</html>
